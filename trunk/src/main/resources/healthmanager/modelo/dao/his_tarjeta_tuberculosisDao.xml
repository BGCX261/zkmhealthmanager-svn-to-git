<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="healthmanager.modelo.dao.His_tarjeta_tuberculosisDao">

	<resultMap id="his_tarjeta_tuberculosisMap" type="his_tarjeta_tuberculosis">
		<result column="codigo_empresa" property="codigo_empresa" />
		<result column="codigo_sucursal" property="codigo_sucursal" />
		<result column="codigo_historia" property="codigo_historia" />
		<result column="identificacion" property="identificacion" />
		<result column="fecha_inicial" property="fecha_inicial" />
		<result column="codigo_prestador" property="codigo_prestador" />
		<result column="nro_ingreso" property="nro_ingreso" />
		<result column="direccion_vivienda" property="direccion_vivienda" />
		<result column="barrio_vivienda" property="barrio_vivienda" />
		<result column="telefono_vivienda" property="telefono_vivienda" />
		<result column="direccion_trabajo" property="direccion_trabajo" />
		<result column="barrio_trabajo" property="barrio_trabajo" />
		<result column="telefono_trabajo" property="telefono_trabajo" />
		<result column="tipo_paciente" property="tipo_paciente" />
		<result column="ips" property="ips" />
		<result column="tipo_tuberculosis" property="tipo_tuberculosis" />
		<result column="localizacion_extrapulmonar" property="localizacion_extrapulmonar" />
		<result column="enfermedad_renal" property="enfermedad_renal" />
		<result column="enfermedad_hepatica" property="enfermedad_hepatica" />
		<result column="vih_sida" property="vih_sida" />
		<result column="diabetes_mellitus" property="diabetes_mellitus" />
		<result column="silicosis" property="silicosis" />
		<result column="desnutricion" property="desnutricion" />
		<result column="alcoholismo" property="alcoholismo" />
		<result column="farmacodependencia" property="farmacodependencia" />
		<result column="enbarazo" property="enbarazo" />
		<result column="terapia_vih" property="terapia_vih" />
		<result column="peso" property="peso" />
		<result column="fecha_fase1" property="fecha_fase1" />
		<result column="fecha_fase2" property="fecha_fase2" />
		<result column="rifampicina1" property="rifampicina1" />
		<result column="rifampicina2" property="rifampicina2" />
		<result column="isonlacida1" property="isonlacida1" />
		<result column="isonlacida2" property="isonlacida2" />
		<result column="pirazinamida1" property="pirazinamida1" />
		<result column="pirazinamida2" property="pirazinamida2" />
		<result column="etambutol1" property="etambutol1" />
		<result column="etambutol2" property="etambutol2" />
		<result column="estreptomicina1" property="estreptomicina1" />
		<result column="estreptomicina2" property="estreptomicina2" />
		<result column="baciloscopia" property="baciloscopia" />
		<result column="cultivo" property="cultivo" />
		<result column="histopatologia" property="histopatologia" />
		<result column="cuadro_clinico" property="cuadro_clinico" />
		<result column="epidemiologico" property="epidemiologico" />
		<result column="radiologico" property="radiologico" />
		<result column="tuberculinico" property="tuberculinico" />
		<result column="ada" property="ada" />
		<result column="bk_1" property="bk_1" />
		<result column="bk_2" property="bk_2" />
		<result column="bk_3" property="bk_3" />
		<result column="tiempo_sintomas" property="tiempo_sintomas" />
		<result column="fecha_diagnostico" property="fecha_diagnostico" />
		<result column="fecha_cultivo" property="fecha_cultivo" />
		<result column="asesoria_vih" property="asesoria_vih" />
		<result column="confirmatoria_vih" property="confirmatoria_vih" />
		<result column="fecha_programada1" property="fecha_programada1" />
		<result column="fecha_programada2" property="fecha_programada2" />
		<result column="fecha_programada3" property="fecha_programada3" />
		<result column="fecha_programada4" property="fecha_programada4" />
		<result column="fecha_programada5" property="fecha_programada5" />
		<result column="fecha_programada6" property="fecha_programada6" />
		<result column="fecha_control_bacteriologico2" property="fecha_control_bacteriologico2" />
		<result column="fecha_control_bacteriologico4" property="fecha_control_bacteriologico4" />
		<result column="fecha_control_bacteriologico6" property="fecha_control_bacteriologico6" />
		<result column="resultado_bk2" property="resultado_bk2" />
		<result column="resultado_bk4" property="resultado_bk4" />
		<result column="resultado_bk6" property="resultado_bk6" />
		<result column="fecha_control_medicina2" property="fecha_control_medicina2" />
		<result column="fecha_control_medicina4" property="fecha_control_medicina4" />
		<result column="fecha_control_medicina6" property="fecha_control_medicina6" />
		<result column="fecha_control_enfermeria1" property="fecha_control_enfermeria1" />
		<result column="fecha_control_enfermeria3" property="fecha_control_enfermeria3" />
		<result column="fecha_control_enfermeria5" property="fecha_control_enfermeria5" />
		<result column="peso1" property="peso1" />
		<result column="peso2" property="peso2" />
		<result column="peso3" property="peso3" />
		<result column="peso4" property="peso4" />
		<result column="peso5" property="peso5" />
		<result column="peso6" property="peso6" />
		<result column="observaciones1" property="observaciones1" />
		<result column="observaciones2" property="observaciones2" />
		<result column="observaciones3" property="observaciones3" />
		<result column="observaciones4" property="observaciones4" />
		<result column="observaciones5" property="observaciones5" />
		<result column="observaciones6" property="observaciones6" />
		<result column="resultado_tratamiento" property="resultado_tratamiento" />
		<result column="fracaso" property="fracaso" />
		<result column="abandono" property="abandono" />
		<result column="fallecio" property="fallecio" />
		<result column="traslado" property="traslado" />
		<result column="fecha_egreso" property="fecha_egreso" />
		<result column="observaciones_tratamiento" property="observaciones_tratamiento" />
		<result column="creacion_date" property="creacion_date" />
		<result column="ultimo_update" property="ultimo_update" />
		<result column="creacion_user" property="creacion_user" />
		<result column="delete_date" property="delete_date" />
		<result column="ultimo_user" property="ultimo_user" />
		<result column="delete_user" property="delete_user" />
	</resultMap>

	<insert id="crear" parameterType="his_tarjeta_tuberculosis">
		insert into public.his_tarjeta_tuberculosis (codigo_empresa,codigo_sucursal,
		codigo_historia,identificacion,fecha_inicial,
		codigo_prestador,nro_ingreso,direccion_vivienda,
		barrio_vivienda,telefono_vivienda,direccion_trabajo,
		barrio_trabajo,telefono_trabajo,tipo_paciente,
		ips,tipo_tuberculosis,localizacion_extrapulmonar,
		enfermedad_renal,enfermedad_hepatica,vih_sida,
		diabetes_mellitus,silicosis,desnutricion,
		alcoholismo,farmacodependencia,enbarazo,
		terapia_vih,peso,fecha_fase1,
		fecha_fase2,rifampicina1,rifampicina2,
		isonlacida1,isonlacida2,pirazinamida1,
		pirazinamida2,etambutol1,etambutol2,
		estreptomicina1,estreptomicina2,baciloscopia,
		cultivo,histopatologia,cuadro_clinico,
		epidemiologico,radiologico,tuberculinico,
		ada,bk_1,bk_2,
		bk_3,tiempo_sintomas,fecha_diagnostico,
		fecha_cultivo,asesoria_vih,confirmatoria_vih,
		fecha_programada1,fecha_programada2,fecha_programada3,
		fecha_programada4,fecha_programada5,fecha_programada6,
		fecha_control_bacteriologico2,fecha_control_bacteriologico4,fecha_control_bacteriologico6,
		resultado_bk2,resultado_bk4,resultado_bk6,
		fecha_control_medicina2,fecha_control_medicina4,fecha_control_medicina6,
		fecha_control_enfermeria1,fecha_control_enfermeria3,fecha_control_enfermeria5,
		peso1,peso2,peso3,
		peso4,peso5,peso6,
		observaciones1,observaciones2,observaciones3,
		observaciones4,observaciones5,observaciones6,
		resultado_tratamiento,fracaso,abandono,
		fallecio,traslado,fecha_egreso,
		observaciones_tratamiento,creacion_date,ultimo_update,
		creacion_user,delete_date,ultimo_user,
		delete_user)

		values (#{codigo_empresa},#{codigo_sucursal},
		#{codigo_historia},#{identificacion},#{fecha_inicial},
		#{codigo_prestador},#{nro_ingreso},#{direccion_vivienda},
		#{barrio_vivienda},#{telefono_vivienda},#{direccion_trabajo},
		#{barrio_trabajo},#{telefono_trabajo},#{tipo_paciente},
		#{ips},#{tipo_tuberculosis},#{localizacion_extrapulmonar},
		#{enfermedad_renal},#{enfermedad_hepatica},#{vih_sida},
		#{diabetes_mellitus},#{silicosis},#{desnutricion},
		#{alcoholismo},#{farmacodependencia},#{enbarazo},
		#{terapia_vih},#{peso},#{fecha_fase1},
		#{fecha_fase2},#{rifampicina1},#{rifampicina2},
		#{isonlacida1},#{isonlacida2},#{pirazinamida1},
		#{pirazinamida2},#{etambutol1},#{etambutol2},
		#{estreptomicina1},#{estreptomicina2},#{baciloscopia},
		#{cultivo},#{histopatologia},#{cuadro_clinico},
		#{epidemiologico},#{radiologico},#{tuberculinico},
		#{ada},#{bk_1},#{bk_2},
		#{bk_3},#{tiempo_sintomas},#{fecha_diagnostico},
		#{fecha_cultivo},#{asesoria_vih},#{confirmatoria_vih},
		#{fecha_programada1},#{fecha_programada2},#{fecha_programada3},
		#{fecha_programada4},#{fecha_programada5},#{fecha_programada6},
		#{fecha_control_bacteriologico2},#{fecha_control_bacteriologico4},#{fecha_control_bacteriologico6},
		#{resultado_bk2},#{resultado_bk4},#{resultado_bk6},
		#{fecha_control_medicina2},#{fecha_control_medicina4},#{fecha_control_medicina6},
		#{fecha_control_enfermeria1},#{fecha_control_enfermeria3},#{fecha_control_enfermeria5},
		#{peso1},#{peso2},#{peso3},
		#{peso4},#{peso5},#{peso6},
		#{observaciones1},#{observaciones2},#{observaciones3},
		#{observaciones4},#{observaciones5},#{observaciones6},
		#{resultado_tratamiento},#{fracaso},#{abandono},
		#{fallecio},#{traslado},#{fecha_egreso},
		#{observaciones_tratamiento},#{creacion_date},#{ultimo_update},
		#{creacion_user},#{delete_date},#{ultimo_user},
		#{delete_user})
	</insert>

	<update id="actualizar" parameterType="his_tarjeta_tuberculosis">
		update public.his_tarjeta_tuberculosis set codigo_empresa = #{codigo_empresa},
		codigo_sucursal = #{codigo_sucursal},codigo_historia = #{codigo_historia},
		identificacion = #{identificacion},fecha_inicial = #{fecha_inicial},
		codigo_prestador = #{codigo_prestador},nro_ingreso = #{nro_ingreso},
		direccion_vivienda = #{direccion_vivienda},barrio_vivienda = #{barrio_vivienda},
		telefono_vivienda = #{telefono_vivienda},direccion_trabajo = #{direccion_trabajo},
		barrio_trabajo = #{barrio_trabajo},telefono_trabajo = #{telefono_trabajo},
		tipo_paciente = #{tipo_paciente},ips = #{ips},
		tipo_tuberculosis = #{tipo_tuberculosis},localizacion_extrapulmonar = #{localizacion_extrapulmonar},
		enfermedad_renal = #{enfermedad_renal},enfermedad_hepatica = #{enfermedad_hepatica},
		vih_sida = #{vih_sida},diabetes_mellitus = #{diabetes_mellitus},
		silicosis = #{silicosis},desnutricion = #{desnutricion},
		alcoholismo = #{alcoholismo},farmacodependencia = #{farmacodependencia},
		enbarazo = #{enbarazo},terapia_vih = #{terapia_vih},
		peso = #{peso},fecha_fase1 = #{fecha_fase1},
		fecha_fase2 = #{fecha_fase2},rifampicina1 = #{rifampicina1},
		rifampicina2 = #{rifampicina2},isonlacida1 = #{isonlacida1},
		isonlacida2 = #{isonlacida2},pirazinamida1 = #{pirazinamida1},
		pirazinamida2 = #{pirazinamida2},etambutol1 = #{etambutol1},
		etambutol2 = #{etambutol2},estreptomicina1 = #{estreptomicina1},
		estreptomicina2 = #{estreptomicina2},baciloscopia = #{baciloscopia},
		cultivo = #{cultivo},histopatologia = #{histopatologia},
		cuadro_clinico = #{cuadro_clinico},epidemiologico = #{epidemiologico},
		radiologico = #{radiologico},tuberculinico = #{tuberculinico},
		ada = #{ada},bk_1 = #{bk_1},
		bk_2 = #{bk_2},bk_3 = #{bk_3},
		tiempo_sintomas = #{tiempo_sintomas},fecha_diagnostico = #{fecha_diagnostico},
		fecha_cultivo = #{fecha_cultivo},asesoria_vih = #{asesoria_vih},
		confirmatoria_vih = #{confirmatoria_vih},fecha_programada1 = #{fecha_programada1},
		fecha_programada2 = #{fecha_programada2},fecha_programada3 = #{fecha_programada3},
		fecha_programada4 = #{fecha_programada4},fecha_programada5 = #{fecha_programada5},
		fecha_programada6 = #{fecha_programada6},fecha_control_bacteriologico2 = #{fecha_control_bacteriologico2},
		fecha_control_bacteriologico4 = #{fecha_control_bacteriologico4},fecha_control_bacteriologico6 = #{fecha_control_bacteriologico6},
		resultado_bk2 = #{resultado_bk2},resultado_bk4 = #{resultado_bk4},
		resultado_bk6 = #{resultado_bk6},fecha_control_medicina2 = #{fecha_control_medicina2},
		fecha_control_medicina4 = #{fecha_control_medicina4},fecha_control_medicina6 = #{fecha_control_medicina6},
		fecha_control_enfermeria1 = #{fecha_control_enfermeria1},fecha_control_enfermeria3 = #{fecha_control_enfermeria3},
		fecha_control_enfermeria5 = #{fecha_control_enfermeria5},peso1 = #{peso1},
		peso2 = #{peso2},peso3 = #{peso3},
		peso4 = #{peso4},peso5 = #{peso5},
		peso6 = #{peso6},observaciones1 = #{observaciones1},
		observaciones2 = #{observaciones2},observaciones3 = #{observaciones3},
		observaciones4 = #{observaciones4},observaciones5 = #{observaciones5},
		observaciones6 = #{observaciones6},resultado_tratamiento = #{resultado_tratamiento},
		fracaso = #{fracaso},abandono = #{abandono},
		fallecio = #{fallecio},traslado = #{traslado},
		fecha_egreso = #{fecha_egreso},observaciones_tratamiento = #{observaciones_tratamiento},
		creacion_date = #{creacion_date},ultimo_update = #{ultimo_update},
		creacion_user = #{creacion_user},delete_date = #{delete_date},
		ultimo_user = #{ultimo_user},delete_user = #{delete_user}
		where codigo_empresa = #{codigo_empresa}
		and codigo_sucursal = #{codigo_sucursal}
		and codigo_historia = #{codigo_historia}
	</update>

	<select id="consultar" parameterType="his_tarjeta_tuberculosis" resultMap="his_tarjeta_tuberculosisMap">
		select codigo_empresa,codigo_sucursal,
		codigo_historia,identificacion,fecha_inicial,codigo_prestador,
		nro_ingreso,direccion_vivienda,barrio_vivienda,telefono_vivienda,
		direccion_trabajo,barrio_trabajo,telefono_trabajo,tipo_paciente,
		ips,tipo_tuberculosis,localizacion_extrapulmonar,enfermedad_renal,
		enfermedad_hepatica,vih_sida,diabetes_mellitus,silicosis,
		desnutricion,alcoholismo,farmacodependencia,enbarazo,
		terapia_vih,peso,fecha_fase1,fecha_fase2,
		rifampicina1,rifampicina2,isonlacida1,isonlacida2,
		pirazinamida1,pirazinamida2,etambutol1,etambutol2,
		estreptomicina1,estreptomicina2,baciloscopia,cultivo,
		histopatologia,cuadro_clinico,epidemiologico,radiologico,
		tuberculinico,ada,bk_1,bk_2,
		bk_3,tiempo_sintomas,fecha_diagnostico,fecha_cultivo,
		asesoria_vih,confirmatoria_vih,fecha_programada1,fecha_programada2,
		fecha_programada3,fecha_programada4,fecha_programada5,fecha_programada6,
		fecha_control_bacteriologico2,fecha_control_bacteriologico4,fecha_control_bacteriologico6,resultado_bk2,
		resultado_bk4,resultado_bk6,fecha_control_medicina2,fecha_control_medicina4,
		fecha_control_medicina6,fecha_control_enfermeria1,fecha_control_enfermeria3,fecha_control_enfermeria5,
		peso1,peso2,peso3,peso4,
		peso5,peso6,observaciones1,observaciones2,
		observaciones3,observaciones4,observaciones5,observaciones6,
		resultado_tratamiento,fracaso,abandono,fallecio,
		traslado,fecha_egreso,observaciones_tratamiento,creacion_date,
		ultimo_update,creacion_user,delete_date,ultimo_user,
		delete_user
		from public.his_tarjeta_tuberculosis where codigo_empresa = #{codigo_empresa}
		and codigo_sucursal = #{codigo_sucursal} and codigo_historia = #{codigo_historia}
		order by cast(codigo_historia as integer)
            desc LIMIT 1 OFFSET 0
	</select>
	
	<select id="consultar_historia" parameterType="his_tarjeta_tuberculosis" resultMap="his_tarjeta_tuberculosisMap">
		select codigo_empresa,codigo_sucursal,
		codigo_historia,identificacion,fecha_inicial,codigo_prestador,
		nro_ingreso,direccion_vivienda,barrio_vivienda,telefono_vivienda,
		direccion_trabajo,barrio_trabajo,telefono_trabajo,tipo_paciente,
		ips,tipo_tuberculosis,localizacion_extrapulmonar,enfermedad_renal,
		enfermedad_hepatica,vih_sida,diabetes_mellitus,silicosis,
		desnutricion,alcoholismo,farmacodependencia,enbarazo,
		terapia_vih,peso,fecha_fase1,fecha_fase2,
		rifampicina1,rifampicina2,isonlacida1,isonlacida2,
		pirazinamida1,pirazinamida2,etambutol1,etambutol2,
		estreptomicina1,estreptomicina2,baciloscopia,cultivo,
		histopatologia,cuadro_clinico,epidemiologico,radiologico,
		tuberculinico,ada,bk_1,bk_2,
		bk_3,tiempo_sintomas,fecha_diagnostico,fecha_cultivo,
		asesoria_vih,confirmatoria_vih,fecha_programada1,fecha_programada2,
		fecha_programada3,fecha_programada4,fecha_programada5,fecha_programada6,
		fecha_control_bacteriologico2,fecha_control_bacteriologico4,fecha_control_bacteriologico6,resultado_bk2,
		resultado_bk4,resultado_bk6,fecha_control_medicina2,fecha_control_medicina4,
		fecha_control_medicina6,fecha_control_enfermeria1,fecha_control_enfermeria3,fecha_control_enfermeria5,
		peso1,peso2,peso3,peso4,
		peso5,peso6,observaciones1,observaciones2,
		observaciones3,observaciones4,observaciones5,observaciones6,
		resultado_tratamiento,fracaso,abandono,fallecio,
		traslado,fecha_egreso,observaciones_tratamiento,creacion_date,
		ultimo_update,creacion_user,delete_date,ultimo_user,
		delete_user
		from public.his_tarjeta_tuberculosis where codigo_empresa = #{codigo_empresa}
		and codigo_sucursal = #{codigo_sucursal} and identificacion = #{identificacion}
		order by cast(codigo_historia as integer)
            desc LIMIT 1 OFFSET 0 
	</select>

	<delete id="eliminar" parameterType="his_tarjeta_tuberculosis">
		delete from public.his_tarjeta_tuberculosis
		where codigo_empresa = #{codigo_empresa}
		and codigo_sucursal = #{codigo_sucursal} and codigo_historia = #{codigo_historia}
	</delete>

	<select id="listar" parameterType="java.util.Map" resultMap="his_tarjeta_tuberculosisMap">
		select codigo_empresa,codigo_sucursal,
		codigo_historia,identificacion,fecha_inicial,codigo_prestador,
		nro_ingreso,direccion_vivienda,barrio_vivienda,telefono_vivienda,
		direccion_trabajo,barrio_trabajo,telefono_trabajo,tipo_paciente,
		ips,tipo_tuberculosis,localizacion_extrapulmonar,enfermedad_renal,
		enfermedad_hepatica,vih_sida,diabetes_mellitus,silicosis,
		desnutricion,alcoholismo,farmacodependencia,enbarazo,
		terapia_vih,peso,fecha_fase1,fecha_fase2,
		rifampicina1,rifampicina2,isonlacida1,isonlacida2,
		pirazinamida1,pirazinamida2,etambutol1,etambutol2,
		estreptomicina1,estreptomicina2,baciloscopia,cultivo,
		histopatologia,cuadro_clinico,epidemiologico,radiologico,
		tuberculinico,ada,bk_1,bk_2,
		bk_3,tiempo_sintomas,fecha_diagnostico,fecha_cultivo,
		asesoria_vih,confirmatoria_vih,fecha_programada1,fecha_programada2,
		fecha_programada3,fecha_programada4,fecha_programada5,fecha_programada6,
		fecha_control_bacteriologico2,fecha_control_bacteriologico4,fecha_control_bacteriologico6,resultado_bk2,
		resultado_bk4,resultado_bk6,fecha_control_medicina2,fecha_control_medicina4,
		fecha_control_medicina6,fecha_control_enfermeria1,fecha_control_enfermeria3,fecha_control_enfermeria5,
		peso1,peso2,peso3,peso4,
		peso5,peso6,observaciones1,observaciones2,
		observaciones3,observaciones4,observaciones5,observaciones6,
		resultado_tratamiento,fracaso,abandono,fallecio,
		traslado,fecha_egreso,observaciones_tratamiento,creacion_date,
		ultimo_update,creacion_user,delete_date,ultimo_user,
		delete_user
		from public.his_tarjeta_tuberculosis 
		<trim prefix="WHERE" prefixOverrides="AND |OR ">
			<if test="codigo_empresa != null">
			AND codigo_empresa = #{codigo_empresa}
			</if>
			<if test="codigo_sucursal != null">
			AND codigo_sucursal = #{codigo_sucursal}
			</if>
			<if test="identificacion != null">
			AND identificacion = #{identificacion}
			</if>
		</trim>
		
		<if test="order_desc" >
			order by cast(codigo_historia as integer) desc
		</if>
		<if test="limit != null">
		${limit}
		</if>
	</select>

	<select id="existe" resultType="java.lang.Boolean">
		select count(1) != 0 AS exist 		from public.his_tarjeta_tuberculosis 
		<trim prefix="WHERE" prefixOverrides="AND |OR ">
			<if test="codigo_empresa != null">
			AND codigo_empresa = #{codigo_empresa}
			</if>
			<if test="codigo_sucursal != null">
			AND codigo_sucursal = #{codigo_sucursal}
			</if>
			<if test="parameter != null">
			AND ${parameter} like '${value}'
			</if>
		</trim>
		<if test="limit != null">
		${limit}
		</if>
	</select>

</mapper>
